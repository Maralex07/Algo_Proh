<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–ª–∞–≤–∏–∞—Ç—É—Ä–Ω—ã–π —Ç—Ä–µ–Ω–∞–∂—ë—Ä</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background-color: #000;
            color: #fff;
            position: relative;
        }
        
        h1 {
            text-align: center;
            color: #bb86fc;
            margin-bottom: 30px;
        }
        
        .container {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .settings-panel {
            flex: 1;
            min-width: 250px;
            background-color: #1e1e1e;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(187, 134, 252, 0.2);
        }
        
        .training-area {
            flex: 2;
            min-width: 400px;
            background-color: #1e1e1e;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(187, 134, 252, 0.2);
            display: flex;
            flex-direction: column;
        }
        
        .task-display {
            flex-grow: 1;
            padding: 30px;
            background-color: #2d2d2d;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 150px;
            border: 1px solid #bb86fc;
            font-size: 24px;
            line-height: 1.5;
            text-align: center;
        }
        
        .current-task {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
            text-align: center;
            color: #ffeb3b;
        }
        
        .hint {
            font-size: 14px;
            color: #bb86fc;
            text-align: center;
            margin-top: 10px;
        }
        
        .input-display {
            width: 100%;
            padding: 15px;
            margin-top: 20px;
            background-color: #2d2d2d;
            border: 1px solid #bb86fc;
            border-radius: 6px;
            color: white;
            font-size: 18px;
            text-align: center;
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
            padding: 15px;
            background-color: #2d2d2d;
            border-radius: 8px;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #ffeb3b;
        }
        
        .stat-label {
            font-size: 12px;
            color: #bb86fc;
            text-transform: uppercase;
        }
        
        .progress-container {
            width: 100%;
            height: 10px;
            background-color: #383838;
            border-radius: 5px;
            margin-top: 20px;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background-color: #bb86fc;
            width: 0%;
            transition: width 0.3s;
        }
        
        .timer-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 10px;
        }
        
        .timer {
            font-size: 24px;
            font-weight: bold;
            color: #ffeb3b;
            background-color: #2d2d2d;
            padding: 8px 16px;
            border-radius: 4px;
            min-width: 100px;
            text-align: center;
        }
        
        .difficulty-controls {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .difficulty-option {
            padding: 10px 15px;
            background-color: #383838;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .difficulty-option.active {
            background-color: #bb86fc;
            color: #000;
            font-weight: bold;
        }
        
        .language-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .language-option {
            flex: 1;
            padding: 10px;
            background-color: #383838;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .language-option.active {
            background-color: #bb86fc;
            color: #000;
            font-weight: bold;
        }
        
        button {
            padding: 12px 24px;
            margin-top: 20px;
            background-color: #bb86fc;
            color: #000;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            width: 100%;
            font-size: 16px;
        }
        
        button:hover {
            background-color: #ffeb3b;
        }
        
        .success-message {
            color: #4CAF50;
            font-weight: bold;
            text-align: center;
            margin-top: 10px;
            height: 20px;
        }
        
        .error-message {
            color: #f44336;
            font-weight: bold;
            text-align: center;
            margin-top: 10px;
            height: 20px;
        }
        
        .keyboard-layout {
            margin-top: 30px;
            text-align: center;
        }
        
        .keyboard-row {
            display: flex;
            justify-content: center;
            margin-bottom: 5px;
        }
        
        .keyboard-key {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 10px;
            margin: 2px;
            background-color: #2d2d2d;
            color: #fff;
            border-radius: 4px;
            border: 1px solid #444;
            font-family: monospace;
            font-size: 14px;
            min-width: 30px;
            height: 40px;
        }
        
        .keyboard-key.active {
            background-color: #ffeb3b;
            color: #000;
            transform: translateY(2px);
            box-shadow: 0 2px 0 #bb86fc;
        }
        
        .keyboard-key.space {
            width: 200px;
        }
        
        .keyboard-key.tab {
            width: 60px;
        }
        
        .keyboard-key.caps {
            width: 70px;
        }
        
        .keyboard-key.enter {
            width: 80px;
        }
        
        .keyboard-key.shift {
            width: 90px;
        }
        
        .keyboard-key.ctrl, .keyboard-key.alt {
            width: 60px;
        }
        
        .accuracy-display {
            width: 100%;
            height: 5px;
            background-color: #383838;
            border-radius: 3px;
            margin-top: 20px;
            overflow: hidden;
            position: relative;
        }
        
        .accuracy-bar {
            height: 100%;
            background-color: #4CAF50;
            width: 100%;
            position: absolute;
            top: 0;
            left: 0;
            transform-origin: left;
            transform: scaleX(1);
        }
        
        .level-display {
            font-size: 16px;
            color: #bb86fc;
            text-align: center;
            margin-top: 10px;
        }
        
        .home-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 10px 15px;
            background-color: #bb86fc;
            color: #000;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            z-index: 100;
        }
        
        .home-btn:hover {
            background-color: #ffeb3b;
            transform: scale(1.1);
        }
    </style>
</head>
<body>
    <h1>–ö–ª–∞–≤–∏–∞—Ç—É—Ä–Ω—ã–π —Ç—Ä–µ–Ω–∞–∂—ë—Ä</h1>
    
    <div class="container">
        <div class="settings-panel">
            <h2 style="color: #ffeb3b;">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
            
            <div class="difficulty-controls">
                <h3 style="color: #bb86fc; margin-bottom: 10px;">–£—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏</h3>
                <div class="difficulty-option active" data-level="beginner">–ù–æ–≤–∏—á–æ–∫</div>
                <div class="difficulty-option" data-level="intermediate">–°—Ä–µ–¥–Ω–∏–π</div>
                <div class="difficulty-option" data-level="advanced">–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π</div>
                <div class="difficulty-option" data-level="expert">–≠–∫—Å–ø–µ—Ä—Ç</div>
            </div>
            
            <div class="language-controls">
                <h3 style="color: #bb86fc; margin-bottom: 10px;">–Ø–∑—ã–∫</h3>
                <div class="language-option active" data-lang="ru">–†—É—Å—Å–∫–∏–π</div>
                <div class="language-option" data-lang="en">–ê–Ω–≥–ª–∏–π—Å–∫–∏–π</div>
            </div>
            
            <h3 style="color: #bb86fc; margin-bottom: 10px;">–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</h3>
            <select id="duration-select" style="width: 100%; padding: 10px; background: #2d2d2d; color: white; border: 1px solid #bb86fc; border-radius: 4px; margin-bottom: 20px;">
                <option value="1">1 –º–∏–Ω—É—Ç–∞</option>
                <option value="3">3 –º–∏–Ω—É—Ç—ã</option>
                <option value="5" selected>5 –º–∏–Ω—É—Ç</option>
                <option value="10">10 –º–∏–Ω—É—Ç</option>
                <option value="0">–ë–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π</option>
            </select>
            
            <button id="start-btn">–ù–∞—á–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É</button>
            <button id="reset-btn" style="margin-top: 10px; background-color: #2d2d2d; color: white;">–°–±—Ä–æ—Å–∏—Ç—å</button>
            
            <div class="level-display" id="level-display">–£—Ä–æ–≤–µ–Ω—å: 1</div>
            
            <div class="progress-container">
                <div class="progress-bar" id="progress-bar"></div>
            </div>
        </div>
        
        <div class="training-area">
            <div class="task-display" id="text-display">
                –ù–∞–∂–º–∏—Ç–µ "–ù–∞—á–∞—Ç—å", —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É
            </div>
            
            <input type="text" class="input-display" id="input-field" placeholder="–í–≤–æ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –∑–¥–µ—Å—å..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" disabled>
            
            <div class="current-task" id="current-task">–ì–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ</div>
            <div class="hint" id="hint">–í—ã–±–µ—Ä–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –Ω–∞–∂–º–∏—Ç–µ "–ù–∞—á–∞—Ç—å"</div>
            
            <div class="success-message" id="success-message"></div>
            <div class="error-message" id="error-message"></div>
            
            <div class="accuracy-display">
                <div class="accuracy-bar" id="accuracy-bar"></div>
            </div>
            
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-value" id="wpm">0</div>
                    <div class="stat-label">–°–ª–æ–≤/–º–∏–Ω</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="cpm">0</div>
                    <div class="stat-label">–ó–Ω./–º–∏–Ω</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="accuracy">100%</div>
                    <div class="stat-label">–¢–æ—á–Ω–æ—Å—Ç—å</div>
                </div>
            </div>
            
            <div class="timer-container">
                <div class="timer" id="timer">00:00</div>
            </div>
            
            <div class="keyboard-layout">
                <div class="keyboard-row">
                    <div class="keyboard-key" data-key="—ë">—ë</div>
                    <div class="keyboard-key" data-key="1">1</div>
                    <div class="keyboard-key" data-key="2">2</div>
                    <div class="keyboard-key" data-key="3">3</div>
                    <div class="keyboard-key" data-key="4">4</div>
                    <div class="keyboard-key" data-key="5">5</div>
                    <div class="keyboard-key" data-key="6">6</div>
                    <div class="keyboard-key" data-key="7">7</div>
                    <div class="keyboard-key" data-key="8">8</div>
                    <div class="keyboard-key" data-key="9">9</div>
                    <div class="keyboard-key" data-key="0">0</div>
                    <div class="keyboard-key" data-key="-">-</div>
                    <div class="keyboard-key" data-key="=">=</div>
                    <div class="keyboard-key" data-key="Backspace" style="width: 80px;">Backspace</div>
                </div>
                <div class="keyboard-row">
                    <div class="keyboard-key tab" data-key="Tab">Tab</div>
                    <div class="keyboard-key" data-key="–π">–π</div>
                    <div class="keyboard-key" data-key="—Ü">—Ü</div>
                    <div class="keyboard-key" data-key="—É">—É</div>
                    <div class="keyboard-key" data-key="–∫">–∫</div>
                    <div class="keyboard-key" data-key="–µ">–µ</div>
                    <div class="keyboard-key" data-key="–Ω">–Ω</div>
                    <div class="keyboard-key" data-key="–≥">–≥</div>
                    <div class="keyboard-key" data-key="—à">—à</div>
                    <div class="keyboard-key" data-key="—â">—â</div>
                    <div class="keyboard-key" data-key="–∑">–∑</div>
                    <div class="keyboard-key" data-key="—Ö">—Ö</div>
                    <div class="keyboard-key" data-key="—ä">—ä</div>
                    <div class="keyboard-key" data-key="\" style="width: 60px;">\</div>
                </div>
                <div class="keyboard-row">
                    <div class="keyboard-key caps" data-key="CapsLock">Caps</div>
                    <div class="keyboard-key" data-key="—Ñ">—Ñ</div>
                    <div class="keyboard-key" data-key="—ã">—ã</div>
                    <div class="keyboard-key" data-key="–≤">–≤</div>
                    <div class="keyboard-key" data-key="–∞">–∞</div>
                    <div class="keyboard-key" data-key="–ø">–ø</div>
                    <div class="keyboard-key" data-key="—Ä">—Ä</div>
                    <div class="keyboard-key" data-key="–æ">–æ</div>
                    <div class="keyboard-key" data-key="–ª">–ª</div>
                    <div class="keyboard-key" data-key="–¥">–¥</div>
                    <div class="keyboard-key" data-key="–∂">–∂</div>
                    <div class="keyboard-key" data-key="—ç">—ç</div>
                    <div class="keyboard-key enter" data-key="Enter">Enter</div>
                </div>
                <div class="keyboard-row">
                    <div class="keyboard-key shift" data-key="Shift">Shift</div>
                    <div class="keyboard-key" data-key="—è">—è</div>
                    <div class="keyboard-key" data-key="—á">—á</div>
                    <div class="keyboard-key" data-key="—Å">—Å</div>
                    <div class="keyboard-key" data-key="–º">–º</div>
                    <div class="keyboard-key" data-key="–∏">–∏</div>
                    <div class="keyboard-key" data-key="—Ç">—Ç</div>
                    <div class="keyboard-key" data-key="—å">—å</div>
                    <div class="keyboard-key" data-key="–±">–±</div>
                    <div class="keyboard-key" data-key="—é">—é</div>
                    <div class="keyboard-key" data-key=".">.</div>
                    <div class="keyboard-key shift" data-key="Shift" style="width: 100px;">Shift</div>
                </div>
                <div class="keyboard-row">
                    <div class="keyboard-key ctrl" data-key="Control">Ctrl</div>
                    <div class="keyboard-key" data-key="Win">Win</div>
                    <div class="keyboard-key alt" data-key="Alt">Alt</div>
                    <div class="keyboard-key space" data-key=" ">Space</div>
                    <div class="keyboard-key alt" data-key="Alt">Alt</div>
                    <div class="keyboard-key" data-key="Win">Win</div>
                    <div class="keyboard-key" data-key="ContextMenu">Menu</div>
                    <div class="keyboard-key ctrl" data-key="Control">Ctrl</div>
                </div>
            </div>
        </div>
    </div>
    
    <button class="home-btn" id="home-btn" title="–ù–∞ –≥–ª–∞–≤–Ω—É—é">‚åÇ</button>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // –≠–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
            const startBtn = document.getElementById('start-btn');
            const resetBtn = document.getElementById('reset-btn');
            const homeBtn = document.getElementById('home-btn');
            const textDisplay = document.getElementById('text-display');
            const inputField = document.getElementById('input-field');
            const currentTask = document.getElementById('current-task');
            const hint = document.getElementById('hint');
            const successMessage = document.getElementById('success-message');
            const errorMessage = document.getElementById('error-message');
            const progressBar = document.getElementById('progress-bar');
            const timer = document.getElementById('timer');
            const levelDisplay = document.getElementById('level-display');
            const accuracyBar = document.getElementById('accuracy-bar');
            const durationSelect = document.getElementById('duration-select');
            
            // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            const wpmDisplay = document.getElementById('wpm');
            const cpmDisplay = document.getElementById('cpm');
            const accuracyDisplay = document.getElementById('accuracy');
            
            // –ö–Ω–æ–ø–∫–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∏ —è–∑—ã–∫–∞
            const difficultyOptions = document.querySelectorAll('.difficulty-option');
            const languageOptions = document.querySelectorAll('.language-option');
            const keyboardKeys = document.querySelectorAll('.keyboard-key');
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
            function generateRandomText(length, language) {
                const ruChars = '–∞–±–≤–≥–¥–µ—ë–∂–∑–∏–π–∫–ª–º–Ω–æ–ø—Ä—Å—Ç—É—Ñ—Ö—Ü—á—à—â—ä—ã—å—ç—é—è ';
                const enChars = 'abcdefghijklmnopqrstuvwxyz ';
                const chars = language === 'ru' ? ruChars : enChars;
                let result = '';
                
                for (let i = 0; i < length; i++) {
                    result += chars.charAt(Math.floor(Math.random() * chars.length));
                }
                
                // –î–µ–ª–∞–µ–º –ø–µ—Ä–≤—É—é –±—É–∫–≤—É –∑–∞–≥–ª–∞–≤–Ω–æ–π
                if (result.length > 0) {
                    result = result.charAt(0).toUpperCase() + result.slice(1);
                }
                
                return result;
            }
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞ –∑–∞–¥–∞–Ω–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
            function generateTextByLevel(level, language) {
                let length, sentences;
                
                switch(level) {
                    case 'beginner':
                        length = Math.floor(Math.random() * 30) + 20; // 20-50 —Å–∏–º–≤–æ–ª–æ–≤
                        sentences = Math.floor(Math.random() * 2) + 1; // 1-2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
                        break;
                    case 'intermediate':
                        length = Math.floor(Math.random() * 100) + 50; // 50-150 —Å–∏–º–≤–æ–ª–æ–≤
                        sentences = Math.floor(Math.random() * 3) + 2; // 2-4 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
                        break;
                    case 'advanced':
                        length = Math.floor(Math.random() * 200) + 100; // 100-300 —Å–∏–º–≤–æ–ª–æ–≤
                        sentences = Math.floor(Math.random() * 5) + 3; // 3-7 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π
                        break;
                    case 'expert':
                        length = Math.floor(Math.random() * 300) + 200; // 200-500 —Å–∏–º–≤–æ–ª–æ–≤
                        sentences = Math.floor(Math.random() * 7) + 5; // 5-11 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π
                        break;
                    default:
                        length = 50;
                        sentences = 2;
                }
                
                let text = '';
                for (let i = 0; i < sentences; i++) {
                    const sentenceLength = Math.floor(length / sentences);
                    text += generateRandomText(sentenceLength, language);
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º —Ç–æ—á–∫—É –≤ –∫–æ–Ω—Ü–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è (–∫—Ä–æ–º–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ)
                    if (i < sentences - 1) {
                        text += '. ';
                        // –°–ª–µ–¥—É—é—â–µ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —Å –∑–∞–≥–ª–∞–≤–Ω–æ–π –±—É–∫–≤—ã
                        if (text.length < length) {
                            text += generateRandomText(1, language).toUpperCase();
                            length--; // –£—á–∏—Ç—ã–≤–∞–µ–º –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–π —Å–∏–º–≤–æ–ª
                        }
                    } else {
                        text += '.';
                    }
                }
                
                return text;
            }
            
            // –°–æ—Å—Ç–æ—è–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
            let isTraining = false;
            let currentLevel = 'beginner';
            let currentLanguage = 'ru';
            let currentText = '';
            let typedText = '';
            let startTime = 0;
            let timerInterval = null;
            let seconds = 0;
            let totalChars = 0;
            let correctChars = 0;
            let errors = 0;
            let currentPosition = 0;
            let trainingDuration = 5 * 60; // 5 –º–∏–Ω—É—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            let timeLeft = trainingDuration;
            let level = 1;
            let xp = 0;
            let xpToNextLevel = 100;
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
            init();
            
            function init() {
                // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
                loadProgress();
                
                // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–æ–±—ã—Ç–∏–π
                setupEventListeners();
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
                updateKeyboardLayout();
            }
            
            function loadProgress() {
                const savedProgress = localStorage.getItem('keyboardTrainerProgress');
                if (savedProgress) {
                    const progress = JSON.parse(savedProgress);
                    level = progress.level || 1;
                    xp = progress.xp || 0;
                    xpToNextLevel = progress.xpToNextLevel || 100;
                    updateLevelDisplay();
                }
            }
            
            function saveProgress() {
                const progress = {
                    level,
                    xp,
                    xpToNextLevel
                };
                localStorage.setItem('keyboardTrainerProgress', JSON.stringify(progress));
            }
            
            function setupEventListeners() {
                // –ö–Ω–æ–ø–∫–∞ —Å—Ç–∞—Ä—Ç–∞
                startBtn.addEventListener('click', startTraining);
                
                // –ö–Ω–æ–ø–∫–∞ —Å–±—Ä–æ—Å–∞
                resetBtn.addEventListener('click', resetTraining);
                
                // –ö–Ω–æ–ø–∫–∞ –¥–æ–º–æ–π
                homeBtn.addEventListener('click', () => {
                    window.location.href = 'index.html';
                });
                
                // –í—ã–±–æ—Ä —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
                difficultyOptions.forEach(option => {
                    option.addEventListener('click', function() {
                        difficultyOptions.forEach(opt => opt.classList.remove('active'));
                        this.classList.add('active');
                        currentLevel = this.dataset.level;
                    });
                });
                
                // –í—ã–±–æ—Ä —è–∑—ã–∫–∞
                languageOptions.forEach(option => {
                    option.addEventListener('click', function() {
                        languageOptions.forEach(opt => opt.classList.remove('active'));
                        this.classList.add('active');
                        currentLanguage = this.dataset.lang;
                        updateKeyboardLayout();
                    });
                });
                
                // –í—ã–±–æ—Ä –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
                durationSelect.addEventListener('change', function() {
                    const minutes = parseInt(this.value);
                    trainingDuration = minutes * 60;
                    if (minutes === 0) trainingDuration = 0; // –ë–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
                });
                
                // –ü–æ–ª–µ –≤–≤–æ–¥–∞
                inputField.addEventListener('input', checkInput);
                inputField.addEventListener('keydown', handleKeyDown);
            }
            
            function updateKeyboardLayout() {
                // –î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã —Å–¥–µ–ª–∞–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É —Ä—É—Å—Å–∫–æ–π –∏ –∞–Ω–≥–ª–∏–π—Å–∫–æ–π —Ä–∞—Å–∫–ª–∞–¥–∫–æ–π
                // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –Ω—É–∂–Ω–æ –±—ã–ª–æ –±—ã —É—á–∏—Ç—ã–≤–∞—Ç—å —Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –∫–ª–∞–≤–∏—à
                if (currentLanguage === 'ru') {
                    // –†—É—Å—Å–∫–∞—è —Ä–∞—Å–∫–ª–∞–¥–∫–∞
                    document.querySelector('[data-key="—ë"]').textContent = '—ë';
                    document.querySelector('[data-key="–π"]').textContent = '–π';
                    document.querySelector('[data-key="—Ü"]').textContent = '—Ü';
                    document.querySelector('[data-key="—É"]').textContent = '—É';
                    document.querySelector('[data-key="–∫"]').textContent = '–∫';
                    document.querySelector('[data-key="–µ"]').textContent = '–µ';
                    document.querySelector('[data-key="–Ω"]').textContent = '–Ω';
                    document.querySelector('[data-key="–≥"]').textContent = '–≥';
                    document.querySelector('[data-key="—à"]').textContent = '—à';
                    document.querySelector('[data-key="—â"]').textContent = '—â';
                    document.querySelector('[data-key="–∑"]').textContent = '–∑';
                    document.querySelector('[data-key="—Ö"]').textContent = '—Ö';
                    document.querySelector('[data-key="—ä"]').textContent = '—ä';
                    document.querySelector('[data-key="—Ñ"]').textContent = '—Ñ';
                    document.querySelector('[data-key="—ã"]').textContent = '—ã';
                    document.querySelector('[data-key="–≤"]').textContent = '–≤';
                    document.querySelector('[data-key="–∞"]').textContent = '–∞';
                    document.querySelector('[data-key="–ø"]').textContent = '–ø';
                    document.querySelector('[data-key="—Ä"]').textContent = '—Ä';
                    document.querySelector('[data-key="–æ"]').textContent = '–æ';
                    document.querySelector('[data-key="–ª"]').textContent = '–ª';
                    document.querySelector('[data-key="–¥"]').textContent = '–¥';
                    document.querySelector('[data-key="–∂"]').textContent = '–∂';
                    document.querySelector('[data-key="—ç"]').textContent = '—ç';
                    document.querySelector('[data-key="—è"]').textContent = '—è';
                    document.querySelector('[data-key="—á"]').textContent = '—á';
                    document.querySelector('[data-key="—Å"]').textContent = '—Å';
                    document.querySelector('[data-key="–º"]').textContent = '–º';
                    document.querySelector('[data-key="–∏"]').textContent = '–∏';
                    document.querySelector('[data-key="—Ç"]').textContent = '—Ç';
                    document.querySelector('[data-key="—å"]').textContent = '—å';
                    document.querySelector('[data-key="–±"]').textContent = '–±';
                    document.querySelector('[data-key="—é"]').textContent = '—é';
                } else {
                    // –ê–Ω–≥–ª–∏–π—Å–∫–∞—è —Ä–∞—Å–∫–ª–∞–¥–∫–∞
                    document.querySelector('[data-key="—ë"]').textContent = '`';
                    document.querySelector('[data-key="–π"]').textContent = 'q';
                    document.querySelector('[data-key="—Ü"]').textContent = 'w';
                    document.querySelector('[data-key="—É"]').textContent = 'e';
                    document.querySelector('[data-key="–∫"]').textContent = 'r';
                    document.querySelector('[data-key="–µ"]').textContent = 't';
                    document.querySelector('[data-key="–Ω"]').textContent = 'y';
                    document.querySelector('[data-key="–≥"]').textContent = 'u';
                    document.querySelector('[data-key="—à"]').textContent = 'i';
                    document.querySelector('[data-key="—â"]').textContent = 'o';
                    document.querySelector('[data-key="–∑"]').textContent = 'p';
                    document.querySelector('[data-key="—Ö"]').textContent = '[';
                    document.querySelector('[data-key="—ä"]').textContent = ']';
                    document.querySelector('[data-key="—Ñ"]').textContent = 'a';
                    document.querySelector('[data-key="—ã"]').textContent = 's';
                    document.querySelector('[data-key="–≤"]').textContent = 'd';
                    document.querySelector('[data-key="–∞"]').textContent = 'f';
                    document.querySelector('[data-key="–ø"]').textContent = 'g';
                    document.querySelector('[data-key="—Ä"]').textContent = 'h';
                    document.querySelector('[data-key="–æ"]').textContent = 'j';
                    document.querySelector('[data-key="–ª"]').textContent = 'k';
                    document.querySelector('[data-key="–¥"]').textContent = 'l';
                    document.querySelector('[data-key="–∂"]').textContent = ';';
                    document.querySelector('[data-key="—ç"]').textContent = "'";
                    document.querySelector('[data-key="—è"]').textContent = 'z';
                    document.querySelector('[data-key="—á"]').textContent = 'x';
                    document.querySelector('[data-key="—Å"]').textContent = 'c';
                    document.querySelector('[data-key="–º"]').textContent = 'v';
                    document.querySelector('[data-key="–∏"]').textContent = 'b';
                    document.querySelector('[data-key="—Ç"]').textContent = 'n';
                    document.querySelector('[data-key="—å"]').textContent = 'm';
                    document.querySelector('[data-key="–±"]').textContent = ',';
                    document.querySelector('[data-key="—é"]').textContent = '.';
                }
            }
            
            function startTraining() {
                if (isTraining) return;
                
                isTraining = true;
                startBtn.textContent = '–ü–∞—É–∑–∞';
                inputField.disabled = false;
                inputField.focus();
                
                // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –¥–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
                currentText = generateTextByLevel(currentLevel, currentLanguage);
                
                // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
                displayText();
                
                // –°–±—Ä–æ—Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
                typedText = '';
                totalChars = currentText.length;
                correctChars = 0;
                errors = 0;
                currentPosition = 0;
                startTime = Date.now();
                seconds = 0;
                timeLeft = trainingDuration;
                
                // –ó–∞–ø—É—Å–∫ —Ç–∞–π–º–µ—Ä–∞
                if (timerInterval) clearInterval(timerInterval);
                updateTimer();
                timerInterval = setInterval(updateTimer, 1000);
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
                currentTask.textContent = `–£—Ä–æ–≤–µ–Ω—å: ${currentLevel}`;
                hint.textContent = `–Ø–∑—ã–∫: ${currentLanguage === 'ru' ? '–†—É—Å—Å–∫–∏–π' : '–ê–Ω–≥–ª–∏–π—Å–∫–∏–π'}`;
                successMessage.textContent = '';
                errorMessage.textContent = '';
                inputField.value = '';
                
                // –°–±—Ä–æ—Å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞
                progressBar.style.width = '0%';
            }
            
            function displayText() {
                let html = '';
                for (let i = 0; i < currentText.length; i++) {
                    if (i < currentPosition) {
                        // –£–∂–µ –Ω–∞–ø–µ—á–∞—Ç–∞–Ω–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã
                        const isCorrect = currentText[i] === typedText[i];
                        const color = isCorrect ? '#4CAF50' : '#f44336';
                        html += `<span style="color: ${color}">${currentText[i]}</span>`;
                    } else if (i === currentPosition) {
                        // –¢–µ–∫—É—â–∏–π —Å–∏–º–≤–æ–ª
                        html += `<span style="background-color: #bb86fc; color: #000; padding: 0 2px;">${currentText[i]}</span>`;
                    } else {
                        // –û—Å—Ç–∞–≤—à–∏–µ—Å—è —Å–∏–º–≤–æ–ª—ã
                        html += currentText[i];
                    }
                }
                textDisplay.innerHTML = html;
            }
            
            function updateTimer() {
                seconds++;
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–∞–π–º–µ—Ä–∞
                const minutes = Math.floor(seconds / 60);
                const remainingSeconds = seconds % 60;
                timer.textContent = `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è —Ä–µ–∂–∏–º–∞ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º
                if (trainingDuration > 0) {
                    timeLeft = trainingDuration - seconds;
                    if (timeLeft <= 0) {
                        finishTraining();
                    }
                }
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
                updateStats();
            }
            
            function checkInput() {
                typedText = inputField.value;
                const currentChar = currentText[currentPosition];
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —Å–∏–º–≤–æ–ª–∞
                if (typedText.length > currentPosition) {
                    const typedChar = typedText[currentPosition];
                    
                    if (typedChar === currentChar) {
                        // –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–∏–º–≤–æ–ª
                        correctChars++;
                        successMessage.textContent = '‚úì –í–µ—Ä–Ω–æ!';
                        errorMessage.textContent = '';
                    } else {
                        // –û—à–∏–±–∫–∞
                        errors++;
                        errorMessage.textContent = '‚úó –û—à–∏–±–∫–∞';
                        successMessage.textContent = '';
                    }
                    
                    currentPosition++;
                    displayText();
                    
                    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
                    const progress = (currentPosition / currentText.length) * 100;
                    progressBar.style.width = `${progress}%`;
                    
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞
                    if (currentPosition >= currentText.length) {
                        completeText();
                    }
                }
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
                updateStats();
            }
            
            function handleKeyDown(e) {
                // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–æ–π –∫–ª–∞–≤–∏—à–∏ –Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –∫–ª–∞–≤–∏–∞—Ç—É—Ä–µ
                const key = e.key.toLowerCase();
                const keyElement = document.querySelector(`[data-key="${key}"]`);
                
                if (keyElement) {
                    keyElement.classList.add('active');
                    
                    // –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–¥—Å–≤–µ—Ç–∫–∏ –ø–æ—Å–ª–µ –æ—Ç–ø—É—Å–∫–∞–Ω–∏—è –∫–ª–∞–≤–∏—à–∏
                    setTimeout(() => {
                        keyElement.classList.remove('active');
                    }, 200);
                }
                
                // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –∫–ª–∞–≤–∏—à
                if (e.key === 'Shift') {
                    document.querySelectorAll('[data-key="Shift"]').forEach(el => el.classList.add('active'));
                } else if (e.key === 'Control') {
                    document.querySelectorAll('[data-key="Control"]').forEach(el => el.classList.add('active'));
                } else if (e.key === 'Alt') {
                    document.querySelectorAll('[data-key="Alt"]').forEach(el => el.classList.add('active'));
                }
            }
            
            function completeText() {
                // –†–∞—Å—á–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –∏ —Å–∫–æ—Ä–æ—Å—Ç–∏
                const timeSpent = (Date.now() - startTime) / 1000; // –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
                const minutesSpent = timeSpent / 60;
                
                // –°–∏–º–≤–æ–ª–æ–≤ –≤ –º–∏–Ω—É—Ç—É
                const cpm = Math.round(currentText.length / minutesSpent);
                
                // –°–ª–æ–≤ –≤ –º–∏–Ω—É—Ç—É (—Å–ª–æ–≤–æ = 5 —Å–∏–º–≤–æ–ª–æ–≤)
                const wpm = Math.round(cpm / 5);
                
                // –¢–æ—á–Ω–æ—Å—Ç—å
                const accuracy = Math.round((correctChars / currentText.length) * 100);
                
                // –ù–∞—á–∏—Å–ª–µ–Ω–∏–µ –æ–ø—ã—Ç–∞
                const xpGained = calculateXPGain(cpm, accuracy);
                xp += xpGained;
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–≤—ã—à–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è
                if (xp >= xpToNextLevel) {
                    level++;
                    xp -= xpToNextLevel;
                    xpToNextLevel = Math.round(xpToNextLevel * 1.5);
                    successMessage.textContent = `üéâ –£—Ä–æ–≤–µ–Ω—å ${level}!`;
                }
                
                // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
                saveProgress();
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
                updateLevelDisplay();
                
                // –í—ã–±–æ—Ä –Ω–æ–≤–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –∏–ª–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
                if (trainingDuration === 0 || timeLeft > 0) {
                    setTimeout(() => {
                        currentText = generateTextByLevel(currentLevel, currentLanguage);
                        totalChars += currentText.length;
                        typedText = '';
                        inputField.value = '';
                        currentPosition = 0;
                        displayText();
                        progressBar.style.width = '0%';
                    }, 1000);
                }
            }
            
            function calculateXPGain(cpm, accuracy) {
                let baseXP = 10;
                
                // –ú–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –∑–∞ —Å–∫–æ—Ä–æ—Å—Ç—å
                if (cpm > 200) baseXP += 20;
                else if (cpm > 150) baseXP += 15;
                else if (cpm > 100) baseXP += 10;
                else if (cpm > 50) baseXP += 5;
                
                // –ú–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –∑–∞ —Ç–æ—á–Ω–æ—Å—Ç—å
                if (accuracy > 95) baseXP += 10;
                else if (accuracy > 90) baseXP += 5;
                else if (accuracy < 70) baseXP -= 5;
                
                // –ú–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –∑–∞ —É—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
                if (currentLevel === 'intermediate') baseXP *= 1.2;
                else if (currentLevel === 'advanced') baseXP *= 1.5;
                else if (currentLevel === 'expert') baseXP *= 2;
                
                return Math.max(5, Math.round(baseXP));
            }
            
            function updateStats() {
                const timeSpent = seconds; // –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
                const minutesSpent = timeSpent / 60;
                
                // –°–∏–º–≤–æ–ª–æ–≤ –≤ –º–∏–Ω—É—Ç—É
                const cpm = minutesSpent > 0 ? Math.round(currentPosition / minutesSpent) : 0;
                
                // –°–ª–æ–≤ –≤ –º–∏–Ω—É—Ç—É (—Å–ª–æ–≤–æ = 5 —Å–∏–º–≤–æ–ª–æ–≤)
                const wpm = Math.round(cpm / 5);
                
                // –¢–æ—á–Ω–æ—Å—Ç—å
                const accuracy = currentPosition > 0 ? Math.round((correctChars / currentPosition) * 100) : 100;
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
                wpmDisplay.textContent = wpm;
                cpmDisplay.textContent = cpm;
                accuracyDisplay.textContent = `${accuracy}%`;
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª–æ—Å–∫–∏ —Ç–æ—á–Ω–æ—Å—Ç–∏
                accuracyBar.style.transform = `scaleX(${accuracy / 100})`;
                
                // –¶–≤–µ—Ç –ø–æ–ª–æ—Å–∫–∏ —Ç–æ—á–Ω–æ—Å—Ç–∏
                if (accuracy > 90) {
                    accuracyBar.style.backgroundColor = '#4CAF50';
                } else if (accuracy > 70) {
                    accuracyBar.style.backgroundColor = '#FFC107';
                } else {
                    accuracyBar.style.backgroundColor = '#F44336';
                }
            }
            
            function updateLevelDisplay() {
                levelDisplay.textContent = `–£—Ä–æ–≤–µ–Ω—å: ${level} (${xp}/${xpToNextLevel} XP)`;
            }
            
            function finishTraining() {
                isTraining = false;
                clearInterval(timerInterval);
                inputField.disabled = true;
                startBtn.textContent = '–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ';
                
                // –ü–æ–∫–∞–∑ –∏—Ç–æ–≥–æ–≤–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
                currentTask.textContent = '–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!';
                hint.textContent = `–í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç: ${cpmDisplay.textContent} –∑–Ω./–º–∏–Ω, —Ç–æ—á–Ω–æ—Å—Ç—å ${accuracyDisplay.textContent}`;
                
                // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–±—â–µ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
                saveTotalStats();
            }
            
            function saveTotalStats() {
                let totalStats = {
                    sessions: 0,
                    minutes: 0
                };
                
                const savedStats = localStorage.getItem('keyboardTrainerTotalStats');
                if (savedStats) {
                    totalStats = JSON.parse(savedStats);
                }
                
                totalStats.sessions += 1;
                totalStats.minutes += Math.floor(seconds / 60);
                
                localStorage.setItem('keyboardTrainerTotalStats', JSON.stringify(totalStats));
            }
            
            function resetTraining() {
                isTraining = false;
                clearInterval(timerInterval);
                inputField.disabled = true;
                inputField.value = '';
                startBtn.textContent = '–ù–∞—á–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É';
                
                // –°–±—Ä–æ—Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
                textDisplay.textContent = '–ù–∞–∂–º–∏—Ç–µ "–ù–∞—á–∞—Ç—å", —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É';
                currentTask.textContent = '–ì–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ';
                hint.textContent = '–í—ã–±–µ—Ä–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –Ω–∞–∂–º–∏—Ç–µ "–ù–∞—á–∞—Ç—å"';
                successMessage.textContent = '';
                errorMessage.textContent = '';
                progressBar.style.width = '0%';
                timer.textContent = '00:00';
                seconds = 0;
                
                // –°–±—Ä–æ—Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
                wpmDisplay.textContent = '0';
                cpmDisplay.textContent = '0';
                accuracyDisplay.textContent = '100%';
                accuracyBar.style.transform = 'scaleX(1)';
                accuracyBar.style.backgroundColor = '#4CAF50';
            }
        });
    </script>
</body>
</html>
